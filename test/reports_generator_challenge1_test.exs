defmodule ReportsGeneratorChallenge1Test do
  use ExUnit.Case

  describe "build/1" do
    test "builds the report" do
      filename = "gen_report_min.csv"

      response = ReportsGeneratorChallenge1.build(filename)

      expected_response = %{
        "all_hours" => %{
          "Cleiton" => 58,
          "Daniele" => 35,
          "Danilo" => 30,
          "Diego" => 51,
          "Giuliano" => 38,
          "Jakeliny" => 57,
          "Joseph" => 48,
          "Mayk" => 50,
          "Rafael" => 35,
          "Vinicius" => 30
        },
        "hours_per_month" => %{
          "Cleiton" => %{
            1 => 0,
            2 => 1,
            3 => 8,
            4 => 5,
            5 => 4,
            6 => 13,
            7 => 7,
            8 => 0,
            9 => 0,
            10 => 14,
            11 => 0,
            12 => 6
          },
          "Daniele" => %{
            1 => 5,
            2 => 1,
            3 => 0,
            4 => 7,
            5 => 8,
            6 => 5,
            7 => 0,
            8 => 0,
            9 => 0,
            10 => 4,
            11 => 0,
            12 => 5
          },
          "Danilo" => %{
            1 => 0,
            2 => 7,
            3 => 4,
            4 => 1,
            5 => 0,
            6 => 3,
            7 => 0,
            8 => 0,
            9 => 0,
            10 => 8,
            11 => 7,
            12 => 0
          },
          "Diego" => %{
            1 => 0,
            2 => 2,
            3 => 14,
            4 => 8,
            5 => 1,
            6 => 6,
            7 => 11,
            8 => 5,
            9 => 3,
            10 => 0,
            11 => 0,
            12 => 1
          },
          "Giuliano" => %{
            1 => 0,
            2 => 9,
            3 => 0,
            4 => 7,
            5 => 4,
            6 => 0,
            7 => 0,
            8 => 3,
            9 => 5,
            10 => 0,
            11 => 8,
            12 => 2
          },
          "Jakeliny" => %{
            1 => 0,
            2 => 0,
            3 => 14,
            4 => 0,
            5 => 1,
            6 => 4,
            7 => 14,
            8 => 7,
            9 => 0,
            10 => 8,
            11 => 0,
            12 => 9
          },
          "Joseph" => %{
            1 => 0,
            2 => 0,
            3 => 3,
            4 => 4,
            5 => 3,
            6 => 0,
            7 => 4,
            8 => 5,
            9 => 4,
            10 => 0,
            11 => 5,
            12 => 20
          },
          "Mayk" => %{
            1 => 0,
            2 => 0,
            3 => 15,
            4 => 4,
            5 => 0,
            6 => 3,
            7 => 7,
            8 => 0,
            9 => 8,
            10 => 0,
            11 => 4,
            12 => 9
          },
          "Rafael" => %{
            1 => 9,
            2 => 0,
            3 => 0,
            4 => 2,
            5 => 0,
            6 => 0,
            7 => 13,
            8 => 11,
            9 => 0,
            10 => 0,
            11 => 0,
            12 => 0
          },
          "Vinicius" => %{
            1 => 0,
            2 => 0,
            3 => 3,
            4 => 0,
            5 => 0,
            6 => 6,
            7 => 8,
            8 => 8,
            9 => 0,
            10 => 5,
            11 => 0,
            12 => 0
          }
        },
        "hours_per_year" => %{
          "Cleiton" => %{2016 => 4, 2017 => 7, 2018 => 13, 2019 => 6, 2020 => 28},
          "Daniele" => %{2016 => 15, 2017 => 3, 2018 => 12, 2019 => 0, 2020 => 5},
          "Danilo" => %{2016 => 7, 2017 => 7, 2018 => 1, 2019 => 14, 2020 => 1},
          "Diego" => %{2016 => 4, 2017 => 24, 2018 => 7, 2019 => 1, 2020 => 15},
          "Giuliano" => %{2016 => 7, 2017 => 8, 2018 => 9, 2019 => 6, 2020 => 8},
          "Jakeliny" => %{2016 => 16, 2017 => 9, 2018 => 6, 2019 => 13, 2020 => 13},
          "Joseph" => %{2016 => 0, 2017 => 4, 2018 => 3, 2019 => 7, 2020 => 34},
          "Mayk" => %{2016 => 11, 2017 => 8, 2018 => 0, 2019 => 13, 2020 => 18},
          "Rafael" => %{2016 => 11, 2017 => 18, 2018 => 0, 2019 => 2, 2020 => 4},
          "Vinicius" => %{2016 => 8, 2017 => 6, 2018 => 0, 2019 => 0, 2020 => 16}
        }
      }

      assert response == expected_response
    end
  end
end
